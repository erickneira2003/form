<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Skin Care Quiz</title>

  <!-- ✅ Load Lato font -->
  <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">

  <style>
    :root {
      --main-color: #000;
      --bg-color: #fff;
      --accent-color: #777;
      --font-family: 'Lato', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body, html {
      font-family: var(--font-family);
      height: 100%;
      background-color: var(--bg-color);
    }

    /* ✅ Main fullscreen layout */
    .quiz-container {
      position: relative;
      width: 100%;
      height: 100vh;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .form-box {
      background-color: rgba(255, 255, 255, 0.95); /* white content box */
      padding: 2rem;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
    }

    h2 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    p {
      color: var(--accent-color);
      margin-bottom: 1rem;
    }

    .options label {
      display: block;
      margin-bottom: 0.5rem;
    }

    button {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background-color: var(--main-color);
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:disabled {
      background-color: var(--accent-color);
      cursor: not-allowed;
    }

    @media (max-width: 767px) {
      .form-box {
        padding: 1.5rem;
      }
    }
  </style>
</head>

<body>

<!-- ✅ The quiz container where backgrounds will change per step -->
<div id="quiz" class="quiz-container">
  <div class="form-box">
    <form id="surveyForm">
      <div id="stepContent">
        <h2>Loading...</h2>
      </div>
      <div style="display: flex; justify-content: space-between;">
        <button type="button" onclick="prevStep()">Back</button>
        <button type="button" onclick="nextStep()">Next</button>
      </div>
    </form>
  </div>
</div>

<script>
  // ✅ Device check
  const isMobile = window.innerWidth <= 767;

  // ✅ Quiz steps with responsive background image for each frame
  const steps = [
    {
      question: "Ready to find your perfect skincare routine?",
      description: "No7 Personalised Skin Analysis helps you find the right products in less than 2 minutes.",
      bg: isMobile ? "mobile-1.jpg" : "desktop-1.jpg"
    },
    {
      question: "What is your skin type?",
      options: ["Normal", "Dry", "Oily", "Combination", "Not Sure"],
      type: "radio",
      name: "skin_type",
      bg: isMobile ? "mobile-2.jpg" : "desktop-2.jpg"
    },
    {
      question: "Do you have sensitive skin?",
      description: "Sensitive skin often feels tight and can become itchy, irritated and visibly red.",
      options: ["Yes", "No"],
      type: "radio",
      name: "sensitive_skin",
      bg: isMobile ? "mobile-3.jpg" : "desktop-3.jpg"
    },
    {
      question: "Do you have any personal skin concerns you would like to improve?",
      type: "checkbox",
      options: ["Fine Lines & Wrinkles", "Under Eye Puffiness", "Redness", "Dull/Tired Skin", "Dryness", "Dark Circles", "Visible Pores", "Lack of Firmness (Face/Neck)", "Hyperpigmentation", "Spots & Blemishes", "Oiliness", "Dark Spots / Age Spots"],
      name: "skin_concerns",
      bg: isMobile ? "mobile-4.jpg" : "desktop-4.jpg"
    },
    {
      question: "Do you think any of these factors could be affecting your skin?",
      type: "checkbox",
      options: ["Sun Exposure", "Pollution / Air Quality", "Variation in Temperature", "Poor Sleep", "Everyday Stress", "Menopause Transition", "Pregnancy / Breast Feeding", "None of these"],
      name: "environmental_factors",
      bg: isMobile ? "mobile-5.jpg" : "desktop-5.jpg"
    },
    {
      question: "Do you identify as a",
      options: ["Female", "Male", "Non-binary", "Other", "Prefer not to say"],
      type: "radio",
      name: "gender",
      bg: isMobile ? "mobile-6.jpg" : "desktop-6.jpg"
    },
    {
      question: "How old are you?",
      options: ["Less than 30", "30-44", "45-60", "More than 60"],
      type: "radio",
      name: "age",
      bg: isMobile ? "mobile-7.jpg" : "desktop-7.jpg"
    },
    {
      question: "Please upload or take a photo",
      type: "file",
      name: "selfie",
      bg: null // ✅ No background for frame 9
    }
  ];

  let currentStep = 0;

  function renderStep() {
    const step = steps[currentStep];
    const container = document.getElementById("stepContent");
    const quizBox = document.getElementById("quiz");

    // ✅ Set background image dynamically
    quizBox.style.backgroundImage = step.bg ? `url('${step.bg}')` : "none";

    // ✅ Render question and inputs
    let html = `<h2>${step.question}</h2>`;
    if (step.description) html += `<p>${step.description}</p>`;

    if (step.type === "radio" || step.type === "checkbox") {
      html += '<div class="options">';
      step.options.forEach(opt => {
        html += `<label><input type="${step.type}" name="${step.name}" value="${opt}" required> ${opt}</label>`;
      });
      html += '</div>';
    } else if (step.type === "file") {
      html += `<input type="file" name="${step.name}" accept="image/*" required />`;
    }

    container.innerHTML = html;
  }

  function nextStep() {
    const form = document.getElementById("surveyForm");
    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    if (currentStep < steps.length - 1) {
      currentStep++;
      renderStep();
    } else {
      submitForm();
    }
  }

  function prevStep() {
    if (currentStep > 0) {
      currentStep--;
      renderStep();
    }
  }

  function submitForm() {
    const form = document.getElementById("surveyForm");
    const formData = new FormData(form);
    const data = {};

    steps.forEach(step => {
      if (step.name) {
        if (step.type === "checkbox") {
          data[step.name] = [];
          form.querySelectorAll(`input[name="${step.name}"]:checked`).forEach(el => {
            data[step.name].push(el.value);
          });
        } else if (step.type === "file") {
          const file = form.querySelector(`input[name="${step.name}"]`).files[0];
          data[step.name] = file ? "uploaded" : "";
        } else {
          const selected = form.querySelector(`input[name="${step.name}"]:checked`);
          data[step.name] = selected ? selected.value : "";
        }
      }
    });

    // ✅ Replace with your own script URL
    fetch("https://script.google.com/macros/s/AKfycbyVADMrbn9Aosc_jX2wl0I2AdqEAJujFdd4orvGdRC8qAOCW1-p3UAIyCteiakClyfS/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    alert("✅ Thank you! Your answers have been submitted.");
    form.reset();
    currentStep = 0;
    renderStep();
  }

  renderStep();
</script>

</body>
</html>

