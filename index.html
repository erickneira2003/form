<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Ensures correct text encoding -->

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- Makes layout responsive on mobile -->

  <title>Skincare Survey</title>
  <!-- Page title shown in browser tab -->

  <style>
    /* Page styling */
    body {
      font-family: sans-serif;
      padding: 1rem;
    }

    /* Each step is hidden by default */
    .step {
      display: none;
    }

    /* Only show the currently active step */
    .step.active {
      display: block;
    }

    /* Add spacing above buttons */
    button {
      margin-top: 1rem;
    }
  </style>
</head>

<body>

  <!-- Main multi-step survey form -->
  <form id="surveyForm">
    
    <!-- STEP 1 -->
    <div class="step active">
      <h2>What is your main skin concern?</h2>
      <!-- Radio options for q1 -->
      <label><input type="radio" name="q1" value="Acne"> Acne</label><br>
      <label><input type="radio" name="q1" value="Wrinkles"> Wrinkles</label><br>
      <label><input type="radio" name="q1" value="Dryness"> Dryness</label><br>
      <!-- Navigation -->
      <button type="button" onclick="nextStep()">Next</button>
    </div>

    <!-- STEP 2 -->
    <div class="step">
      <h2>How often do you use sunscreen?</h2>
      <!-- Radio options for q2 -->
      <label><input type="radio" name="q2" value="Daily"> Daily</label><br>
      <label><input type="radio" name="q2" value="Sometimes"> Sometimes</label><br>
      <label><input type="radio" name="q2" value="Never"> Never</label><br>
      <!-- Navigation -->
      <button type="button" onclick="prevStep()">Back</button>
      <button type="button" onclick="nextStep()">Next</button>
    </div>

    <!-- STEP 3 -->
    <div class="step">
      <h2>Where do you live?</h2>
      <!-- Text input for city -->
      <input type="text" name="q3" placeholder="City or Region" required><br>
      <!-- Navigation -->
      <button type="button" onclick="prevStep()">Back</button>
      <button type="submit">Submit</button>
    </div>
  </form>

  <script>
    // Select all step containers
    const steps = document.querySelectorAll(".step");

    // Track the currently visible step (starts at 0)
    let currentStep = 0;

    // Show only the selected step
    function showStep(index) {
      steps.forEach((step, i) => {
        step.classList.toggle("active", i === index);
      });
    }

    // Go forward
    function nextStep() {
      if (currentStep < steps.length - 1) {
        currentStep++;
        showStep(currentStep);
      }
    }

    // Go back
    function prevStep() {
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    }

    // Form submission handler
    document.getElementById("surveyForm").addEventListener("submit", function(e) {
      e.preventDefault(); // Prevents page reload

      // Gather the form data
      const formData = new FormData(this);
      const jsonData = Object.fromEntries(formData.entries());

      // Send data to Google Apps Script Web App
      fetch("https://script.google.com/macros/s/AKfycbyVADMrbn9Aosc_jX2wl0I2AdqEAJujFdd4orvGdRC8qAOCW1-p3UAIyCteiakClyfS/exec", {
        method: "POST",
        body: JSON.stringify(jsonData),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(res => res.text())
      .then(response => {
        // Show success message and reset the form
        alert("✅ Thank you! Your response was saved.");
        this.reset();
        currentStep = 0;
        showStep(currentStep);
      })
      .catch(error => {
        // Show error message if something fails
        alert("❌ There was a problem. Please try again.");
        console.error("Submission error:", error);
      });
    });
  </script>
</body>
</html>
